<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">
      <meta name="robots" content="noindex">

    <title>State of collapsible content not set programmatically | Accessibility Issues</title>

    <!--[if gt IE 8]><!--><link href="../../stylesheets/screen.css" rel="stylesheet" media="screen" /><!--<![endif]-->
    <!--[if lte IE 8]><link href="../../stylesheets/screen-old-ie.css" rel="stylesheet" media="screen" /><![endif]-->

    <link rel="canonical" href="//issue/show-hide-state-not-set/">


    <link href="../../stylesheets/print.css" rel="stylesheet" media="print" />
    <script src="../../javascripts/application.js"></script>

      <meta property="og:image" content="//images/govuk-large.png" />
      <meta property="og:site_name" content="Accessibility Issues" />
      <meta property="og:title" content="State of collapsible content not set programmatically" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="//issue/show-hide-state-not-set/" />
      <meta property="twitter:card" content="summary" />
      <meta property="twitter:image" content="//images/govuk-large.png" />
      <meta property="twitter:title" content="State of collapsible content not set programmatically | Accessibility Issues" />
      <meta property="twitter:url" content="//issue/show-hide-state-not-set/" />
  </head>

  <body>
    <div class="app-pane">
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="skip-link">Skip to main content</a>

        <header class="header header--full-width">
  <div class="header__container">
    <div class="header__brand">
        <a href="https://alphagov.github.io/accessibility-issues/">
        <span class="header__title">
          Accessibility Issues
            <span class="phase-banner">Alpha</span>
        </span>
        </a>
    </div>

      <div data-module="navigation">
        <button type="button" class="header__navigation-toggle js-nav-toggle" aria-controls="navigation" aria-label="Show or hide top level navigation">Menu</button>

        <nav id="navigation" class="header__navigation js-nav" aria-label="Top Level Navigation" aria-hidden="true">
          <ul>
              <li>
                <a href="https://github.com/alphagov/accessibility-issues">
                  GitHub
                </a>
              </li>
          </ul>
        </nav>
      </div>
  </div>
</header>

      </div>

      <div id="toc-heading" class="toc-show fixedsticky">
        <a href="#toc" class="toc-show__label js-toc-show" aria-controls="toc">
          Table of contents <span class="toc-show__icon"></span>
        </a>
      </div>

      <div class="app-pane__body" data-module="in-page-navigation">
        <div class="app-pane__toc">
          <div class="toc" data-module="table-of-contents">
            <a href="#" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></a>
            <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
              <ul>
  <li>
    <a href="#title">State of collapsible content not set programmatically</a>
    <ul>
      <li>
        <a href="#code-example">Code example</a>
      </li>
      <li>
        <a href="#why-it-39-s-a-problem">Why it’s a problem</a>
      </li>
      <li>
        <a href="#how-to-test-for-it">How to test for it</a>
      </li>
      <li>
        <a href="#how-to-fix-it">How to fix it</a>
      </li>
      <li>
        <a href="#which-audit-tools-find-it">Which audit tools find it</a>
      </li>
    </ul>
  </li>
</ul>

            </nav>
          </div>
        </div>

        <div class="app-pane__content toc-open-disabled">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
            
  <h1 id="title">State of collapsible content not set programmatically</h1>

  <dl class="data">
    <dt>Severity</dt>
    <dd class="strength3">
        Critical
    </dd>

    <dt>Complexity</dt>
    <dd class="strength1">
        Easy
    </dd>

    <dt>Prevalence</dt>
    <dd class="strength2">
        Can happen
    </dd>

    <dt>Detectability</dt>
      <dd class="strength3">
        0%
      </dd>

  <dt>WCAG Success Criterion</dt>
    <dd>1.3.1</dd>

    <dt>Concerns</dt>
    <dd>code</dd>

    <dt>Impairments</dt>
    <dd>visual</dd>
</dl>

  
  <h2 id="code-example"><a href="example.html">Code example</a></h2>

  <iframe src="example.html" title="Code example for 'State of collapsible content not set programmatically'"></iframe>

    <pre class="html"><code>&lt;div class=&quot;collapsible&quot;&gt;
  &lt;div class=&quot;target&quot; id=&quot;hidden-content&quot;&gt;
    This will be expanded
  &lt;&#x2F;div&gt;
&lt;&#x2F;div&gt;</code></pre>

    <pre class="css"><code>.target[aria-expanded=false] {
  display: none;
}</code></pre>

    <pre class="js"><code>function ready(fn) {
  if (document.attachEvent ? document.readyState === &#x27;complete&#x27; : document.readyState !== &#x27;loading&#x27;){
    fn();
  } else {
    document.addEventListener(&#x27;DOMContentLoaded&#x27;, fn);
  }
}

function createTrigger() {
  var trigger = document.createElement(&#x27;button&#x27;);
  trigger.classList.add(&#x27;trigger&#x27;);
  trigger.textContent = &#x27;Expand&#x27;;
  return trigger;
}

function toggleVisibility(trigger, target) {
  if (target.getAttribute(&#x27;aria-expanded&#x27;) == &#x27;false&#x27;) {
    target.setAttribute(&#x27;aria-expanded&#x27;, true);
    trigger.textContent = &#x27;Collapse&#x27;;
  } else {
    target.setAttribute(&#x27;aria-expanded&#x27;, false);
    trigger.textContent = &#x27;Expand&#x27;;
  }
}

function showHide(){
  var containers = document.querySelectorAll(&#x27;.collapsible&#x27;);

  Array.prototype.forEach.call(containers, function(container, i){
    var target = container.querySelector(&#x27;.target&#x27;);
    target.setAttribute(&#x27;aria-expanded&#x27;, false);

    var trigger = createTrigger();
    container.insertBefore(trigger, container.firstChild);

    trigger.onclick = function(){ toggleVisibility(trigger, target); };
  });
}

ready(showHide);</code></pre>



  <p>A button expands and collapses some initially hidden content underneath it. But it cannot be determined programmatically what the button does, so it does not get announced to screen readers.</p>
<h2 id="why-it-39-s-a-problem">Why it&rsquo;s a problem</h2>
<p>When the purpose of a button which expands hidden text is not announced to screen reader users, they don&rsquo;t have any way of knowing that there is more content. They would miss that additional content.</p>

<p>When the text of the button is clear (like here it changes from &ldquo;Expand&rdquo; to &ldquo;Collapse&rdquo;), this does not seem as bad. But screen readers do not announce this change of content (without extra code). So users stay as clueless.</p>
<h2 id="how-to-test-for-it">How to test for it</h2>
<p>Use a screen reader. Testing tools don&rsquo;t find this.</p>
<h2 id="how-to-fix-it">How to fix it</h2>
<p>Move the <code>aria-expanded</code> attribute to the element which triggers the show/hide functionality. Although it is <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-expanded">according to spec</a>, it doesn&rsquo;t work with any of the major screen readers.
It is advised to then also add a <code>aria-controls</code> attribute which should include the <code>id</code> of the affected element.</p>
<div class="highlight"><pre class="highlight plaintext"><code>&lt;button aria-expanded="false" aria-controls="hidden-content"&gt;Expand&lt;/button&gt;
</code></pre></div>


  

    <h2 id="which-audit-tools-find-it">Which audit tools find it</h2>

  <table>
    <tbody>
        <tr>
          <th>Tenon</th>
          <td class="notfound">not found</td>
        </tr>
        <tr>
          <th>AChecker</th>
          <td class="notfound">not found</td>
        </tr>
        <tr>
          <th>aXe</th>
          <td class="notfound">not found</td>
        </tr>
        <tr>
          <th>Asqa&shy;tasun</th>
          <td class="notfound">not found</td>
        </tr>
        <tr>
          <th>Sort&shy;Site</th>
          <td class="notfound">not found</td>
        </tr>
        <tr>
          <th>WAVE</th>
          <td class="notfound">not found</td>
        </tr>
        <tr>
          <th>HTML_&shy;Code&shy;Sniffer</th>
          <td class="notfound">not found</td>
        </tr>
        <tr>
          <th>Google ADT</th>
          <td class="untested">not tested yet</td>
        </tr>
        <tr>
          <th><abbr title=European Internet Inclusion Initiative>EIII</abbr></th>
          <td class="untested">not tested yet</td>
        </tr>
        <tr>
          <th>Nu Html Checker</th>
          <td class="notfound">not found</td>
        </tr>
        <tr>
          <th>Site&shy;improve</th>
          <td class="notfound">not found</td>
        </tr>
        <tr>
          <th><abbr title=Functional Accessibility Evaluator>FAE</abbr></th>
          <td class="notfound">not found</td>
        </tr>
        <tr>
          <th>AS&shy;Lint</th>
          <td class="notfound">not found</td>
        </tr>
    </tbody>
  </table>



            
          </main>

            <ul class="contribution-banner">
              <li><a href="https://github.com/alphagov/accessibility-issues/blob/master/source/issue/show-hide-state-not-set/index.html.md">View source</a></li>
              <li><a href="https://github.com/alphagov/accessibility-issues/issues/new?labels=bug&amp;title=Re:%20'State%20of%20collapsible%20content%20not%20set%20programmatically'&amp;body=Problem%20with%20'State%20of%20collapsible%20content%20not%20set%20programmatically'%20(//issue/show-hide-state-not-set/)">Report problem</a></li>
              <li><a href="https://github.com/alphagov/accessibility-issues">GitHub Repo</a></li>
            </ul>

          <footer class="footer">
  <div class="footer__licence">
    <a class="footer__licence-logo" href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="license">Open Government Licence</a>
    <p class="footer__licence-description">All content is available under the <a href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="license">Open Government Licence v3.0</a>, except where otherwise stated</p>
  </div>

  <div class="footer__copyright">
    <a class="footer__copyright-logo" href="http://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/copyright-and-re-use/crown-copyright/">© Crown copyright</a>
  </div>
</footer>

        </div>
      </div>
    </div>

    
  </body>
</html>
